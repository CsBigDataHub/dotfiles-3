#!/bin/zsh

# Syncs the gdrive git repo.
output_file=/tmp/gdrive-sync.txt
output_size="$(wc -c < $output_file)"
if (( output_size > 32 * 1024 )); then
  > $output_file
fi

date >> $output_file

cd /Users/jschaf/gdrive
PATH="/usr/local:$PATH"

output="$($HOME/bin/git-sync 2>&1)"
if [[ $! -gt 0 ]]; then
  osascript -e "display notification \"ERROR: ${output}\" with title \"gdrive sync\""

  echo '\nERROR' >> $output_file
  date >> $output_file
  echo "output: $output" >> $output_file
else
  osascript -e "display notification \"okay\" with title \"gdrive sync\""
fi

